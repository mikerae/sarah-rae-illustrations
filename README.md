# Sarah Rae Illustrations
[View the site here](https://sarah-rae-illustrations-d721ea03fb61.herokuapp.com/)
## An E-Commerce Site
This is fifth project contribution to the Code Institute Full Stack Diploma, and is inspired by the Code Institute E-Commerce Walkthrough project 'Boutique Ado'.
Appropriate accreditation is hereby given for any similarities between this project and the Code Institute E-Commerce Walkthrough project 'Boutique Ado'.

# 

# Buisness Model: Buisness to Customer
This site will present the Artwork of Sarah Rae and facilitate the sale of this artwork though an e-commerce website.
## Artwork Purchase
Customers will be able to:
- Purchase selected artworks using an industry standard secure on-line purchasing method.
- By updated on the progress of their order, from placement to delivery.
- Create a customer account to facilitate purchases
- View different categories of available artwork
- View artwork productsin detail, with detailed descriptions of the product.
- View digital art work in a gallery
- Indicate ‘liked’ artworks
- Sign up to a Newsletter
- Access Sarah Rae’s  Social Media sites 
- Commission bespoke artwork
Sarah Rae will be able to:
- Sell her artworks to customers through the e-commerce site
- Promote her internet presence.
- Negotiate commissioned art work.
- Analys and manage her stock levels .
- Track Order progress from placement to delivery.
## Commissioned Artwork
Customers will be able to:
- Initiate dialogue with Sarah Rae regarding the commissioning of bespoke Artwork
Sarah Rae will be able to:
- Conduct dialogue with prospective commissioners with a view to developing a commissioned Artwork Service.
## Marketing
### Search Engine Optimisation
The site will optimise its visibility to prospective customers through Search Engines with the use of the following:
- A robots.txt file
- A sitemap.xml file
- Descriptive meta tags
- rel attributes on links to external resources
### Social Media
Links to the following Sarah Rae Illustrations social media platforms will be clearly available:
- Facebook Buisness page
- Instagram
# User Stories
![User Stories 1](/readme_files/user_stories/user_stories_1.png)
![User Stories 2](/readme_files/user_stories/user_stories_2.png)
![User Stories 3](/readme_files/user_stories/user_stories_3.png)
![User Stories 4](/readme_files/user_stories/user_stories_4.png)

# Models
The following models were used:
- Product
- Category
- Stock
- Orders
- OrderLineItem
- UserProfile
- DigitalArtWork
- ProcessingStatus
## Entity Relationship Diagram
![ERD](/readme_files/erd/erd.png)
## Schema
![ERD](/readme_files/erd/schema.png)
# Wire Frames
## Mobile
![Index m](/readme_files/wire_frames/mobile/index-m.png)
![Index Hamburger m](/readme_files/wire_frames/mobile/index-hamburger-m.png)
![Index Hamburger Expanded m](/readme_files/wire_frames/mobile/index-m-hamburger-expanded.png)
![Index Search 1 m](/readme_files/wire_frames/mobile/index-m-search-1.png)
![Index Search 2 m](/readme_files/wire_frames/mobile/index-m-search-2.png)
![Index My Account m](/readme_files/wire_frames/mobile/index-m-my-account.png)
![Sign Up m](/readme_files/wire_frames/mobile/index-m-my-account-signup.png)
![Sign In m](/readme_files/wire_frames/mobile/index-m-my-account-login.png)
![Products m](/readme_files/wire_frames/mobile/products-m.png)
![Category Selection m](/readme_files/wire_frames/mobile/category-selection-m.png)
![Products Sort m](/readme_files/wire_frames/mobile/products-sort-m.png)
![Products Detail m](/readme_files/wire_frames/mobile/product-detail-m.png)
![Product or Art Work new Window .](/readme_files/wire_frames/mobile/product-or-art-work-image-new-window-m.png)
![Add to Bag Success! m](/readme_files/wire_frames/mobile/add-to-bag-success!-m.png)
![Shopping Bag Empy m](/readme_files/wire_frames/mobile/shopping-bag-empty-m.png)
![Shopping bar Items m](/readme_files/wire_frames/mobile/shopping-bag-items-m.png)
![Checkout 1 m](/readme_files/wire_frames/mobile/checkout-1-m.png)
![Checkout 2 m](/readme_files/wire_frames/mobile/checkout-2-m.png)
![Gallery m](/readme_files/wire_frames/mobile/gallery-m.png) 
![About Sarah-m](/readme_files/wire_frames/mobile/about-sarah-m.png)
![Commissions m](/readme_files/wire_frames/mobile/commissions-m.png)
![My Account Menu m](/readme_files/wire_frames/mobile/index-my-account-m.png)
![Product Management m](/readme_files/wire_frames/mobile/product-management-m.png)
![Gallery Management m](/readme_files/wire_frames/mobile/gallery-management-m.png)
## Tablet
![Index t](/readme_files/wire_frames/tablet/index-t.png)
![Index Hamburger t](/readme_files/wire_frames/tablet/index-hamburger-t.png)
![Index Hamburger Expanded t](/readme_files/wire_frames/tablet/index-t-hamburger-expanded.png)
![Index Search 1 t](/readme_files/wire_frames/tablet/index-t-search-1.png)
![Index Search 2 t](/readme_files/wire_frames/tablet/index-t-search-2.png)
![Index My Account t](/readme_files/wire_frames/tablet/index-my-account-t.png)
![Sign Up t](/readme_files/wire_frames/tablet/index-t-my-account-signup.png)
![Sign In t](/readme_files/wire_frames/tablet/index-t-my-account-login.png)
![Products t](/readme_files/wire_frames/tablet/products-t.png)
![Category Selection t](/readme_files/wire_frames/tablet/category-selection-t.png)
![Sort t](/readme_files/wire_frames/tablet/shop-now-sort-t.png)
![Product Detail t](/readme_files/wire_frames/tablet/product-detail-t.png)
![Product or Atwork New Window t](/readme_files/wire_frames/tablet/product-or-artwork-image-new-window-t.png)
![Add to Bag Success t](/readme_files/wire_frames/tablet/add-to-bag-success!-t.png)
![Shopping Bag Empty t](/readme_files/wire_frames/tablet/shopping-bag-empty-t.png)
![Shopping Bag Items t](/readme_files/wire_frames/tablet/shopping-bag-items-t.png)
![Checkout 1 t](/readme_files/wire_frames/tablet/checkout-1-t.png)
![Checkout 2 t](/readme_files/wire_frames/tablet/checkout-2-t.png)
![Gallery t](/readme_files/wire_frames/tablet/gallery-t.png)
![Commissions t](/readme_files/wire_frames/tablet/commissions-t.png)
![About Sarah t](/readme_files/wire_frames/tablet/about-sarah-t.png)
![My Account Menu t](/readme_files/wire_frames/tablet/index-t-my-account.png)
![Product Management t](/readme_files/wire_frames/tablet/product-management-t.png)
![Gallery Management t](/readme_files/wire_frames/tablet/gallery-management-t.png)
## Desktop
![Index d](/readme_files/wire_frames/desktop/index-d.png)
![Shop Landing d](/readme_files/wire_frames/desktop/shop-landing-d.png)
![Shop Landing Menus d](/readme_files/wire_frames/desktop/shop-landing-menus-d.png)
![Shop Category Selection d](/readme_files/wire_frames/desktop/shop-category-selection-example-d.png)
![Product Detail d](/readme_files/wire_frames/desktop/product-detail-d.png)
![Add to Bag Success! d](/readme_files/wire_frames/desktop/add-to-bag-success!-d.png)
![Shopping Bag Empty d](/readme_files/wire_frames/desktop/shopping-bag-empty-d.png)
![Shopping Bag Items d](/readme_files/wire_frames/desktop/shopping-bag-items-d.png)
![Checkout d](/readme_files/wire_frames/desktop/checkout-d.png)
![Gallery d](/readme_files/wire_frames/desktop/gallery-landing-d.png)
![Product-ArtWork New Window d](/readme_files/wire_frames/desktop/product-or-art-work-image-new-window-d.png)
![Commissions d](/readme_files/wire_frames/desktop/commissions-landing-d.png)
![About Sarah d](/readme_files/wire_frames/desktop/about-sarah-landing-d.png)
![My Account Menu](/readme_files/wire_frames/desktop/index-my-account-d.png)
![Sign Up d](/readme_files/wire_frames/desktop/signup-d.png)
![Sign In d](/readme_files/wire_frames/desktop/sign-in-d.png)
![Product Management d](/readme_files/wire_frames/desktop/product-management-d.png)
![Gallery Management d](/readme_files/wire_frames/desktop/gallery-management-d.png)


![Am I Responsive](#)

# Orchestra String Rota
Code Institute Milestone Project 4
Written in python, developed on GitPod and Git Hub and deployed via Heroku.
## You can view a live version [here](https://string-rota.herokuapp.com/)
## Contents
+ [Project Summary](#project-summary)
+ [Design Thinking](#design-thinking)
+ [UXD](#uxd)
    + [Strategy](#strategy)
    + [Scope](#scope)
    + [Structure](#structure)
    + [Skeleton](#skeleton)
    + [Surface](#surface)
+ [Agile Development](#agile-development)
+ [Database Design](#database-design)
+ [Technologies Used](#technologies-used)
+ [Resources](#resources)
+ [Development](#development)
+ [Bugs and Fixes](#bugs-and-fixes)
+ [Known Issues](#known-issues)
+ [Deployment](#deployment)
+ [Acknowledgments](#acknowledgments)

## Project Summary
This app facilitates members of the string sections of the RSNO to view seating plans and related information for a set of RSNO projects. It facilitates Rota Managers of these sections to create and manage their scetion rotas, and facilatates members of the office to integrate this information into their own work flows.
A sample set of RSNO project data was used to simulate conection to RSNO the server.
## Design Thinking
The phases of design thinking were followed in the development of this project:
- Empathize: Recorded, 15 minute nterviews were conducted with stakeholders using a questions template. The stakeholders were from the RSNO were:
    - Rota Managers from each of the 5 String Sections
    - A player from each of the 5 String Sections 
    - 2 Office managers: one who fixes guest players, and mangages seating positions, and one who mnagags time off permissions.
- The remaining phase (Define, Ideate, Prototype and Test) were acheived through the Agile development process described below.


The interview questions were:
![String Rota Questions](/readme_assets/images/string_rota_questions.png)
## UXD
[Back to Top](#contents)
### Strategy
User Stories generated were used to drive the UXD.
In general there were 3 broad user stories:
-  As a menber of my string section (Violin 1, Violin 2, Viola, Cello, Double Bass) I  can view project seating plans and related data so that I can  know when I am required to play, and be reasured that rota descissions are reasonable.
- As a rota manager for my section (Violin 1, Violin 2, Viola, Cello, Double Bass) I can create and manage a rota and related data for each project so that I can publish this to my collegues.
- As an member of the office, I can view and edit all rota data so that I can integrate this data into my office work flows.
### Scope
The scope of the Minimum Viable Product can be seen in the Sprints in the Github repository.
A snapshot of one Sprint is:
![Sprint Snapshot](assets/images/sprint-1-scope-example.png)
#### Features
- User Login Landing Page, to preserve privacy, security and to allocate appropriate permissions.
- Vew project seating plans and related data by a player's section
- Create and manage seating plans and data for a rota manager's section
- Office managers can view and edit all information.
#### Future Development
[Back to Top](#contents)
Future versions may include integration with live RSNO data.
### Structure
[Back to Top](#contents)
#### Flow Chart
![xxx](//readme_assets/images/#)


### Skeleton
[Back to Top](#contents)

#### XX

##### Features
T
### Surface
[Back to Top](#contents)

#### XX



## Agile Development
[Back to Top](#contents)
The Agile design process was used to some for this limited project.
- User stories were derivd from interviws with stakeholders. These user stories were refined from 'epic' to more specific userstories.
- The was an element of Predicted Project Effort, with story points being allocated to some user stories. 
- The GitHub platform was used to facilitate Agile Development:
- A backlog was used to hold all user stories for processing and allocation. A Github Milestone was used as a backlog.
- Spints were defined to define development tasks needed to bring the project to MMinimum Viable Product level. Other Github Milestones were used to hold user stories allocated to these sprints.
- Issues were prioritised according to Moscow principles. Github Labels were used mark user stories accordingly.
    - Must have: < 60% of total story points in iteration
    - Should have: the rest
    - Could have: 20% of total story points in iteration
    - Won't have
- Information Radiators were used to monitor the progress of the project development.
    - GitHub Projects were used of rthis purpuse as Kanban Boards 
    - Boards were created for the following:
        - Backlog
        - Set Up
        - Sprint 1: to prepare for mid-project  Mentor session
        - Sprint 2: to complete and submit project for assesment
## Database Design
[Back to Top](#contents)
### Mission Statement
The purpose of the string-rota database is to facilitate the creation, management and disemination of Orchestral String Section Rotas and related data.
### Mission Objectives
- Present Orchestral Program data for each project
- Create and view section seating plans for each project
- Maintain and present player Natural Free Day Data
- Maintain and present player Reserve status for each project
- Maintain and present player Reduced-Repertoitre status for each project
### Requirements
#### User Requirements
1. Return a list of all projects
2. Return a seating plan for a specific string section project
3. Return a list of who is Reserve for each project
4. Return a list of who is not required for Reduced Repertoire.
5. Return a player's current Natural Free Day Data in the context of their annual quota.
6. Return an historical list of Reserve Allcations for each player.
#### Rota-Manager Requirements
1. Add players to specific seating positions for each project
2. Allocate Reserve/On/Off/Not-Available Status to each player in the Rota-Manager's section for each  project.
3. Allocate Reduced-Repertoire status to particular players per project.
4. Create and edit Seating Plans and allocations in draft mode, and pubish to users when ready.
#### Office Requirements
1. Return a seating plan for all sections per project
2. Return Natural Free Day Allcoation and totals for each player, for each project
3. Return roling totals for Natural Free Day Allocations and usage for each player
4. Return a list of all players with Reserve status for each project
5. Edit and update all 
#### System Requirements
1. Return Program Data
2. Return Seating Position Data for each player, project and section.
3. Store and Calculate Natural Free Day allocations and totals based on Allocation for each porject.
4. Store and Return Reserve player status for each project.
### Preliminary Field List
![Preliminary Field List](/readme_assets/images/preliminary-field-list.png)
### Resolution of Field and Table anomilies
Inorder to resolve field and table anomilies, and in order to preserve data integrity the following process was followed:
- The tables were flattened, and populated with data.
    - Any problematic fields were resolved
- The resulting fields and tables were compared with the characteristics of a sound field or table.

Very Academy produced a helfull checklist to evaluate fields and tables (https://www.youtube.com/watch?v=ycw8ZsT1ofw&t=1901s):
![Field and Table Checklist](/readme_assets/images/field-and-table-checklist.png)

When attempting to flatten the project table, the resulting table produced duplicate data, further need for flattening and some caluculated data:
![Example of field and table problem resolution](/readme_assets/images/example-of-field-table-problem-resolution-1.png)

The products table was amended to remove duplucate data, multi-data fields and calculated fields. At this point the checklists above were mostly saticefied.

![Rationalisation of project table](/readme_assets/images/rationalisation-of-product-table.png)

#### Model Entity Relationship Diagram (EDR)
The entities for this project have the following relationships and attributes:
![String-Rota-Erd](/readme_assets/images/string-roto-erd.png)
#### Model Schemas
The Models Schemas erds for this project are:
![String-Rota-erd-Schema](/readme_assets/images/string-rota-erd-schema.png)
#### Model Cretation
The models were created from least dependant (eg Repertoire) to most dependant.
#### Initial data input
Tables were poplulated starting from least dependant using utility function to import from a private google worksheet where RSNO data had been pre-cleaned manually.
Where a reltionship exists between tables, both sides were populated first, then the connection was made manually in the project admin.
Whilst automating this process is understood to be possible, it is beyond the scope of this project to implement for this release.
The one case where a table was populated by script was the the Player_Project link table. Here a script was used to iterate over each player for each project.
 

## Technologies Used
[Back to Top](#contents)

### Languages

The development environment used was GitPod
### Virtual Environment
- A virtual environment was used to ensure compatibility in deployment. A template containing all standard project requirements was prepared by the Code Institute.
- The environment was updated with additional requirements by downloading them into the environment via the terminal, and the requirements.txt file was updated using the following code:
```
pip3 freeze > requirements.txt
```
### Git
Git was used for version control
### GitHub
GitHub was used for external project storage and display
### Libraries
The following libraries were used:
#### psycopg2-2.9.5
#### Django-4.1.3

#### gspread google-auth

#### pandas numpy pyjanitor

#### Python Libraries
The following internal python libraries were used:
- 
## Resources
[Back to Top](#contents)

The following resources were used:
+ Code Institute Training Material
+ Walkthroughs
    + CI ....

+ Python Documentation
+ Django Documentation: https://docs.djangoproject.com/en/3.2/ref/
+ Stack Overflow: https://stackoverflow.com/
+ Wikapedia: https://en.wikipedia.org/wiki/Main_Page
## Development
[Back to Top](#contents)

### Setting Up Development Environment
A gitHub repository was created using a required Code Institute template. This template created a virtual environment within the GitPod workspace which contained requirements for the Milestone 4 project.
#### Local Set Up
The following libraries were installed in the gitPPod workspace:
- psycopg2-2.9.5
``` gitpod /workspace/string-rota (main) $ pip3 install psycopg2 ```
- dj_database_url-1.0.0 ``` gitpod /workspace/string-rota (main) $ pip3 install dj_database_url ```

- Django-4.1.3 gunicorn-20.1.0 
``` gitpod /workspace/string-rota (main) $ pip3 install django gunicorn ```
- dj3_cloudinary_storage-0.0.6
``` gitpod /workspace/string-rota (main) $ pip3 install dj3-cloudinary-storage ```
pip

The details of the currently installed libraries were stored in the file requirements.txt so that Heroku can load them on ddeployment:
```
pip3 freeze --local > requirements.txt
```
This stored the following requirements:
```
asgiref==3.3.4
cachetools==5.2.0
cloudinary==1.25.0
cryptography==3.4.8
dj-database-url==0.5.0
dj3-cloudinary-storage==0.0.5
Django==3.2.3
django-allauth==0.44.0
django-crispy-forms==1.11.2
django-summernote==0.8.11.6
google-api-core==2.11.0
google-api-python-client==2.68.0
google-auth==2.15.0
google-auth-httplib2==0.1.0
google-auth-oauthlib==0.7.1
googleapis-common-protos==1.57.0
gspread==5.7.2
gunicorn==20.1.0
httplib2==0.21.0
lazy_loader==0.1rc2
multipledispatch==0.6.0
natsort==8.2.0
oauthlib==3.1.1
pandas-flavor==0.3.0
protobuf==4.21.10
psycopg2==2.8.6
pyasn1==0.4.8
pyasn1-modules==0.2.8
PyJWT==2.1.0
python3-openid==3.2.0
pytz==2021.1
requests-oauthlib==1.3.0
rsa==4.9
scipy==1.9.3
sqlparse==0.4.1
tabulate==0.9.0
tqdm==4.64.1
xarray==2022.12.0
```

A Django project was created:
``` gitpod /workspace/string-rota (main) $ django-admin startproject django_string_rota . ```

The Django install was tested by running the server:
``` gitpod /workspace/string-rota (main) $ python3 manage.py runserver ```

A browser window was opened using the port : http://127.0.0.1:8000/
and the default Django landing page was diplayed, demonstrating a succesful install.

The string_rota app was created in Django using: ``` gitpod /workspace/string-rota (main) $ python3 manage.py startapp string_rota ```

The string_rota app was added to the list of installed apps in the settings.py file
```
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'string_rota',
]
```

A number of the lines in the settings.py file were raising a linting error because they were too long for standard use in a terminal. Since these settings were not going to be visible in a terminal, the errors were supresssed by adding the following to the end of the long line:
```
  # noqa E501
```

The changes to the Django database were migrated, using the following command:
```
gitpod /workspace/string-rota (main) $ python3 manage.py migrate
```
#### Create app on Heroku
The app "string-rota" was created on Heroku by:
- Logging into Heroku
- Clicking on New
    - Click "Create new app"
- Giving the app a unique name.
    - "string-rota" was accepted as unique
- The region was chosen as:
    - Europe
- The app was created:
    - Click "Create app"

#### Create database on ElephantSQL
The database "string-rota" was created on ElephantSQL by:
- Logging into ElephantSQL
- Click on "Create New Instance"
- The plan was named "string-rota"
- The plan type was " Tiny Turtle (Free)
- CLick on "Select Region"
- "EU-West-1 (Ireland)" was selected by default
- Click on "Review"
- Click on "Create Instance"

#### Store database environment variables in env.py
- create a file "env.py" at the top directory in the workspace, at the same level as requirements.txt
- ensure that "env.py" is added to .gitignore so that it's sensetive contents are not pushed to github.
- In env.py
    - Import the os library
    - Add the DATABASE URL to the environment

        ``` 
        import os
        os.environ["DATABASE_URL"] = "<copiedURL>"
        ```
    where "copiedURL" is replaced by the copied elephantSQL "string-rota" URL

    - Add a secret key to the environment
        ```
        os.environ["SECRET_KEY"] = "my_super^secret@key"
        ```
#### Modify settings.py
- The following code was added to the settings.py file below PATH import:
```
import os
import dj_database_url
if os.path.isfile('env.py'):
    import env
```
- Replace the insecure Django SECRET_KEY with the env.py SECRET_KEY
```
SECRET_KEY = os.environ.get('SECRET_KEY')
```
- Comment out the default database url variable (which would have conected Django to the internal db.sqlite3 database) and add a link to the env.py database url (the ElephantSQL remote database)
```
DATABASES = {
    'default': dj_database_url.parse(os.environ.get("DATABASE_URL"))
}
```
#### Migrate changes to django database
```
gitpod /workspace/string-rota (main) $ python3 manage.py migrate
```
#### Test conection with remote ElephantSQL database
- In the dashborad for ElephantSQL (logged in)
    - select "string-rota" instance
    - on the left menu
        - selcet BROWSER
        - select 'Table queries'
            - observe the dropdown is populated. This means that tables have been created by django in this database, and that the connection between django and the database is made.
#### Add Environment Varriables to Heroku
- In 'string-rota'
    - Click on 'Reveal Config Vars'
    - Add the follwing KEYS and their corresponding VALUES (without "")from env.py:
        - DATABASE_URL
        - SECRET_KEY
        - PORT 8000
#### Add Cloudinary Environment Varriable
- In created Cloudinary Account
    - Copy 
- In env.py
    - add environment variable:
    ```
    os.environ["CLOUDINARY_URL"] = "copied_url"
    ```
- In Heroku Config Vars
    - Add CLOUDINARY_URL: copied_url
#### Add Temporary Config Var to Heroku
There are no static files yet, and without the following variable set, the build will fail on Heroku.
Once static files are introduced into the project, this variable can be removed.
- DISABLE_COLLECTSATICK:1
#### Update Installed Apps and media/ static files in settings.py
The deploymet platform, Heroku, is epherimal i.e. when it is not being used, it stops running activiely and any state data is lost. It is necessary, therefore, to store static files in a permenant state localtion. For this project, Cloudinary was used as the permenante storage location for the static files.
- add 'cloudinary_storage' above 'django.contrib.staticfiles'
```
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'cloudinary_storage',
    'django.contrib.staticfiles',
    'cloudinary',
    'string_rota',
]
```
- below STATIC_URL = '/static/'  add the following:
```
STATICFILES_STORAGE = 'cloudinary_storage.storage.StaticHashedCloudinaryStorage'  # noqa E501
STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')

MEDIA_URL = '/media/'
DEFAULT_FILE_STRORAGE = 'cloudinary_storage.storage.MediaCloudinaryStorage'
```
#### Add a Templates Directory in settings.py
- under BASE_DIR = Path(__file__).resolve().parent.parent add the following:
```
TEMPLATES_DIR = os.path.join(BASE_DIR, 'templates')
```
- in TEMPATES give 'DIRS' the value 'TEMPLATES'
```
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [TEMPLATES_DIR],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
```
#### Add Heroku Host Name in Settings.py
- in ALLOWED_HOSTS add the heroku app name
```
ALLOWED_HOSTS = ['string-rota.herokuapp.com', 'localhost']
```
#### Create 3 directories in the top level director, next to manage.py
- 'media'
- 'static'
- 'templates'
#### Create a Procfile
This tells Heroku that thew app will be displayed using the gunicorn webserver
- Create 'Procfile' at the top level, next to manage.py
```
web: gunicorn django_string_rota.wsgi
```
#### Push to GitHub and connect repository to Heroku
- Push to git hub
- In Heroku, string-rota:
    - Click on 'Deploy"
    - Select GitHub Connect to Github
    - Select the string-rota repository
    - choose auomatic deployment

#### Build, deploy and open app on Heroku
After some trouble-shooting (see bugs and fixes) the default Django landing page was shown on the Heroku deployed site.

#### RSNO Program and Player Data
Access to live RSNO data was not within the scope of this project.
This access was assumed. To simulate live project data and current player data then following data was received from the RSNO in csv form: 
- a 4 week schedule of orchestal projects
- a list of string player names and their Annual Natural Free Day Allocation
##### Data Security
The RSNO data is private. No RSNO data is accesible via the Github repository, and the data is only accessable via the Heroku deployed app for authenticated users.
To preserve this level of privacy, a private google drive was used to store the RSNO data before importing it into the project.

These RSNO csv files were imported into a google worksheet, stored on the private google drive.
The worksheet data was accessed using the google drive and gspread APIs.

The worksheets were separated into separate sheets reflecting the structure of the project models. The data was cleaned manually. In future versions, data would be cleaned using Pandas, Numpy and Pyjanitor.

The worksheet data was imported incrementally into the database using a script run from the terminal.  Niroj in https://www.edureka.co/community/73739/django-script-access-model-objects-without-using-manage-shell, and the Django documantation provided a solution to access the project models for this purpose, since specific Django setup code was needed for stand-alone scripts.




### XX

### Full development of Minimum Viable Product
The Minimum Viable Product as defined in stage one of the development scope above was developed and deployed before progressing to stage two and beyond.


## Testing
[Back to Top](#contents)

### Automatic Testing
### Manual Testing
Table
#### Human Testing

### Incremental Function Testing
As each function and logic code was added and adapted, the code was tested to ensure its functionality was as expected.

### Python PEP8CI 
Python code
The code was tested using PEP8CI online http:# and passed without issue.
![#](#)

### JavaScript

### HTML

### CSS


###  pycodestyle Python Linter

### VSC Debugger
Extensive use of the built in debugger was used to test the more complex aspects of the code. Breakpoints were used to stop the code at particular points so that the values of particular variables could be examined.


### PEP8

## Bugs and Fixes
[Back to Top](#contents)

### First Deployment Fail
```
       Failed to build backports.zoneinfo
       ERROR: Could not build wheels for backports.zoneinfo, which is required to install pyproject.toml-based projects
```
- Stack Overflow: 20BCS055_Ankur Mishira writes:
"In order to do that you need to tell heroku to switch that version and it can be done as follows :

Create runtime.txt in root directory.
python-3.8.10 <- write this in 'runtime.txt' there as to specify the version.
heroku will then install this version and you will be not getting anymore error."
- The next build failed:
```
-----> Building on the Heroku-22 stack
-----> Determining which buildpack to use for this app
-----> Python app detected
-----> Using Python version specified in runtime.txt
 !     Requested runtime 'python-3.8.10' is not available for this stack (heroku-22).
 !     For supported versions, see: https://devcenter.heroku.com/articles/python-support
 !     Push rejected, failed to compile Python app.
 !     Push failed
```
- Installed version of Python is:
```
gitpod /workspace/string-rota (main) $ python3 --version
Python 3.8.11
```
- Heroku supported versions of Python are:
python-3.11.0 on all supported stacks
python-3.10.8 on all supported stacks (recommended)
python-3.9.15 on all supported stacks
python-3.8.15 on Heroku-18 and Heroku-20 only
python-3.7.15 on Heroku-18 and Heroku-20 only
- Removed runtime.txt file, added Python buildpack to Heroku
    - Build failed with same error:
    ```
Failed to build backports.zoneinfo
       ERROR: Could not build wheels for backports.zoneinfo, which is required to install pyproject.toml-based projects
 !     Push rejected, failed to compile Python app.
 !     Push failed
    ```
It was determined that I used an incompatible version of Django.
Django was uninstalled
Then re-installed using:
```
pip3 install Django==3.2
pip3 freeze --local > requirements.txt
```
After further Heroku build fails, Code Institue Student Support recomended re-installing all libraries using the following:
```
pip3 uninstall -r requirements.txt -y
```
The contents of requirements.txt was replaced from:
I would recommend using the versions of packages used in the walkthrough. First you can uninstall existing packages:
https://github.com/Code-Institute-Solutions/Django3blog/blob/master/12_final_deployment/requirements.txt
Then the new requirements were installedfor  the packages listed in the requirements file:
pip3 install -r requirements.txt

After this, the build on Heroku succeeded , but the app did not open.
The app log showed that a comma was missing in the INSTALLED APPS.
This was corrected to:
```
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'cloudinary_storage',
    'django.contrib.staticfiles',
    'cloudinary',
    'string_rota',
]
```
The build deployed  successfully, and the app opend with the default Django landing page.

### Static Files not found on Heroku
After initial deployment to Heroku, the admin section would not style on the Heroku site but would style on the local site.
Fix: When DEBUG=False, Heroku can collect and read the static files.
### Static Files not read when NiceAdmin templates were used.
Static files were not found on either local or Heroku sites.
The NiceAdmin templates referenced the assets folder using and absolute path.
Fic: Django was set up to reference the files using a relative path. To fix this, the following steps were taken:
- the static settings were confirmed to be correct: 
```
 STATIC_URL = '/static/'
STATICFILES_STORAGE = 'cloudinary_storage.storage.StaticHashedCloudinaryStorage'  # noqa E501
STATICFILES_DIRS = [os.path.join(BASE_DIR, 'static')]
STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')
```
- The static files were in the top project directory ( /static/assests/... )
- The path to static files was changed: 
```  <link href="assets/css/style.css" rel="stylesheet"> ```
 was changed to ``` <link rel="stylesheet" href="{% static 'assets/css/style.css' %}"> ```, and all references to static files in the assets folder were also changed. The changes were made in the base.html file.
- The django static variable was loaded at the top of basde.html:
``` {% load static %}```
## Known Issues
[Back to Top](#contents)

### MultipleObjectsReturned Disney Project
When clicking on the Disney Project, it now throws a MultipleObjectsReturned error for get().
```
MultipleObjectsReturned at /home/recording-sessions-for-disney/
get() returned more than one Player_Project -- it returned 2!
Request Method:	GET
Request URL:	http://localhost:8000/home/recording-sessions-for-disney/
Django Version:	3.2.3
Exception Type:	MultipleObjectsReturned
Exception Value:	
get() returned more than one Player_Project -- it returned 2!
Exception Location:	/workspace/.pip-modules/lib/python3.8/site-packages/django/db/models/query.py, line 439, in get
Python Executable:	/home/gitpod/.pyenv/versions/3.8.11/bin/python3
Python Version:	3.8.11
Python Path:	
['/workspace/string-rota',
 '/home/gitpod/.pyenv/versions/3.8.11/lib/python38.zip',
 '/home/gitpod/.pyenv/versions/3.8.11/lib/python3.8',
 '/home/gitpod/.pyenv/versions/3.8.11/lib/python3.8/lib-dynload',
 '/workspace/.pip-modules/lib/python3.8/site-packages',
 '/home/gitpod/.pyenv/versions/3.8.11/lib/python3.8/site-packages']
Server time:	Wed, 28 Dec 2022 22:49:08 +0000
```
The other prjects work fine. In Admin,  have checked:
- that all projects have unique slugs. 
- that there are no duplicate player_project records
- that there are not 2 Player_Project models

I changed the post() method in EditSeatingPosition() view to ensure that the player was difined by the seating position being edited:
```
sp_player = seating_position.player
        player_project = get_object_or_404(
            Player_Project,
            player=sp_player,
            project=project
            )
```
No fix as yet: I might need to delete the Disney Project and associated records, and rebuild it manually....

## Deployment
[Back to Top](#contents)

### Initial Development Deployment
The project was deployed to Heroku in the intitial stages of development in order to resolve early and fundamental deployment issues.

# !!!!! Review and update all of the following!!!!!

The project was deployed to the Heroku platform using the following steps:
- Delete unused resources/libraries
- Add \n to input line
- pip3 freeze > requirements.txt
- commit & push to gitHub
- make Heroku account
- create new app (in Heroku)
- in dashboard : open settings
- in settings : open config vars
    - add config vars
        - creds.json to config vars (these are environment variables, not exposed to the public). Key: “CREDS”, Value: the contents of creds.json
        -  key: “PORT”, Value : “8000”
    - Add build packs:
        - Heroku/python
- in deploy
    - choose deployment method
        - GitHub
        - connect to GitHub
        - Authorise Heroic to access your gitHub
        - search for and connect to repository name
        - choose a deployment method (Enable Automatic Deploys)
        - master/main branch
        - click view to open a web page with the deployment in a browser

#### Freeze requirements
Before deployment, the imported libraries were frozen into the requirement.txt file so that they could be available in the deployed virtual environment. The following code was used:
```
pip3 freeze > requirements.txt
```
This is the contents of the project requirements.txt file:

xx


### Final Deployement
The following additional steps were taken before final deployment
- Django debug mode was set to FALSE
- The GitHub Repository was made public
The project was deployed to the Heroku platform using the following steps:
- Delete unused resources/libraries
- Add \n to input line
- pip3 freeze > requirements.txt
- commit & push to gitHub
- make Heroku account
- create new app (in Heroku)
- in dashboard : open settings
- in settings : open config vars
    - add config vars
        - creds.json to config vars (these are environment variables, not exposed to the public). Key: “CREDS”, Value: the contents of creds.json
        -  key: “PORT”, Value : “8000”
    - Add build packs:
        - Heroku/python
        - Heroic/nodejs
- in deploy
    - choose deployment method
        - GitHub
        - connect to GitHub
        - Authorise Heroic to access your gitHub
        - search for and connect to repository name
        - choose a deployment method (Enable Automatic Deploys)
        - master/main branch
        - click view to open a web page with the deployment in a browser


## Acknowledgments
[Back to Top](#contents)
- Mentor: Martina Terlevic and Darío Carrasquel for their amazing guidance and encouragement
- Code Institute: for training materials, training environment and specific code
- Stack Overflow https://stackoverflow.com/
- Django Documentation https://docs.djangoproject.com/en/3.2/ref/models/fields/